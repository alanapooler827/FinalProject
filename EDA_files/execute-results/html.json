{
  "hash": "03e60b36465c6e550bd64cad556c78e4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exploratory Data Analysis\"\nauthor: \"Alana Pooler\"\ndate: \"2025-11-19\"\nformat: html\n---\n\n# Introduction\n\nThe data used in this project comes from the 2015 Behavioral Risk Factor Surveillance System report conducted by the CDC. View the data set on [Kaggle](https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset/?select=diabetes_binary_health_indicators_BRFSS2015.csv).\n\nThe data set contains 22 variables. The variable 'Diabetes_binary' (diabetes or no diabetes) will be used as the response variable for modeling. This leaves 21 variables as potential predictors, which include information like whether or not the subject has high blood pressure, BMI, age, general health rating (self-assessed), and more. The cleaned data set from Kaggle contains 253,680 survey responses.\n\nWe will first explore the data and investigate the relationships between variables to get a sense of what variables could be useful for modeling. Then, we will build two models to predict the Diabetes_binary variable using a selection of the 21 predictor variables. We will be building a classification tree and a random forest model and evaluating the predictions from each to determine the best model.\n\n# Data Preparation\n\nImport libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\n```\n:::\n\n\nRead in data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_csv(\"data/diabetes_binary_health_indicators_BRFSS2015.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 253680 Columns: 22\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (22): Diabetes_binary, HighBP, HighChol, CholCheck, BMI, Smoker, Stroke,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\n# view first few rows of data\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 22\n  Diabetes_binary HighBP HighChol CholCheck   BMI Smoker Stroke\n            <dbl>  <dbl>    <dbl>     <dbl> <dbl>  <dbl>  <dbl>\n1               0      1        1         1    40      1      0\n2               0      0        0         0    25      1      0\n3               0      1        1         1    28      0      0\n4               0      1        0         1    27      0      0\n5               0      1        1         1    24      0      0\n6               0      1        1         1    25      1      0\n# ℹ 15 more variables: HeartDiseaseorAttack <dbl>, PhysActivity <dbl>,\n#   Fruits <dbl>, Veggies <dbl>, HvyAlcoholConsump <dbl>, AnyHealthcare <dbl>,\n#   NoDocbcCost <dbl>, GenHlth <dbl>, MentHlth <dbl>, PhysHlth <dbl>,\n#   DiffWalk <dbl>, Sex <dbl>, Age <dbl>, Education <dbl>, Income <dbl>\n```\n\n\n:::\n:::\n\n\nCheck for missing values\n\nNo missing values in any column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum_na <- function(column){\n sum(is.na(column))\n}\n\ndf |> summarize(across(everything(), sum_na))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 22\n  Diabetes_binary HighBP HighChol CholCheck   BMI Smoker Stroke\n            <int>  <int>    <int>     <int> <int>  <int>  <int>\n1               0      0        0         0     0      0      0\n# ℹ 15 more variables: HeartDiseaseorAttack <int>, PhysActivity <int>,\n#   Fruits <int>, Veggies <int>, HvyAlcoholConsump <int>, AnyHealthcare <int>,\n#   NoDocbcCost <int>, GenHlth <int>, MentHlth <int>, PhysHlth <int>,\n#   DiffWalk <int>, Sex <int>, Age <int>, Education <int>, Income <int>\n```\n\n\n:::\n:::\n\n\nView column types\n\nAll of the variables are numeric, but most of them are categorical variables encoded as numbers, so we will need to change those\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(df, class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Diabetes_binary               HighBP             HighChol \n           \"numeric\"            \"numeric\"            \"numeric\" \n           CholCheck                  BMI               Smoker \n           \"numeric\"            \"numeric\"            \"numeric\" \n              Stroke HeartDiseaseorAttack         PhysActivity \n           \"numeric\"            \"numeric\"            \"numeric\" \n              Fruits              Veggies    HvyAlcoholConsump \n           \"numeric\"            \"numeric\"            \"numeric\" \n       AnyHealthcare          NoDocbcCost              GenHlth \n           \"numeric\"            \"numeric\"            \"numeric\" \n            MentHlth             PhysHlth             DiffWalk \n           \"numeric\"            \"numeric\"            \"numeric\" \n                 Sex                  Age            Education \n           \"numeric\"            \"numeric\"            \"numeric\" \n              Income \n           \"numeric\" \n```\n\n\n:::\n:::\n\n\nLook at unique values of each variable to see which ones should be converted into factors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(df, table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$Diabetes_binary\n\n     0      1 \n218334  35346 \n\n$HighBP\n\n     0      1 \n144851 108829 \n\n$HighChol\n\n     0      1 \n146089 107591 \n\n$CholCheck\n\n     0      1 \n  9470 244210 \n\n$BMI\n\n   12    13    14    15    16    17    18    19    20    21    22    23    24 \n    6    21    41   132   348   776  1803  3968  6327  9855 13643 15610 19550 \n   25    26    27    28    29    30    31    32    33    34    35    36    37 \n17146 20562 24606 16545 14890 14573 12275 10474  8948  7181  5575  4633  4147 \n   38    39    40    41    42    43    44    45    46    47    48    49    50 \n 3397  2911  2258  1659  1639  1500  1043   819   750   622   484   416   372 \n   51    52    53    54    55    56    57    58    59    60    61    62    63 \n  253   215   237   113   169   109    86    71    54    63    35    43    34 \n   64    65    66    67    68    69    70    71    72    73    74    75    76 \n   24    19    13    15    14     9    15    49    14    47    16    52     3 \n   77    78    79    80    81    82    83    84    85    86    87    88    89 \n   55     1    66     2    49    37     2    44     1     1    61     2    28 \n   90    91    92    95    96    98 \n    1     1    32    12     1     7 \n\n$Smoker\n\n     0      1 \n141257 112423 \n\n$Stroke\n\n     0      1 \n243388  10292 \n\n$HeartDiseaseorAttack\n\n     0      1 \n229787  23893 \n\n$PhysActivity\n\n     0      1 \n 61760 191920 \n\n$Fruits\n\n     0      1 \n 92782 160898 \n\n$Veggies\n\n     0      1 \n 47839 205841 \n\n$HvyAlcoholConsump\n\n     0      1 \n239424  14256 \n\n$AnyHealthcare\n\n     0      1 \n 12417 241263 \n\n$NoDocbcCost\n\n     0      1 \n232326  21354 \n\n$GenHlth\n\n    1     2     3     4     5 \n45299 89084 75646 31570 12081 \n\n$MentHlth\n\n     0      1      2      3      4      5      6      7      8      9     10 \n175680   8538  13054   7381   3789   9030    988   3100    639     91   6373 \n    11     12     13     14     15     16     17     18     19     20     21 \n    41    398     41   1167   5505     88     54     97     16   3364    227 \n    22     23     24     25     26     27     28     29     30 \n    63     38     33   1188     45     79    327    158  12088 \n\n$PhysHlth\n\n     0      1      2      3      4      5      6      7      8      9     10 \n160052  11388  14764   8495   4542   7622   1330   4538    809    179   5595 \n    11     12     13     14     15     16     17     18     19     20     21 \n    60    578     68   2587   4916    112     96    152     22   3273    663 \n    22     23     24     25     26     27     28     29     30 \n    70     56     72   1336     69     99    522    215  19400 \n\n$DiffWalk\n\n     0      1 \n211005  42675 \n\n$Sex\n\n     0      1 \n141974 111706 \n\n$Age\n\n    1     2     3     4     5     6     7     8     9    10    11    12    13 \n 5700  7598 11123 13823 16157 19819 26314 30832 33244 32194 23533 15980 17363 \n\n$Education\n\n     1      2      3      4      5      6 \n   174   4043   9478  62750  69910 107325 \n\n$Income\n\n    1     2     3     4     5     6     7     8 \n 9811 11783 15994 20135 25883 36470 43219 90385 \n```\n\n\n:::\n:::\n\n\nConvert columns to factors where appropriate\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# specify columns to skip\nskip_convert <- c('BMI', 'MentHlth', 'PhysHlth')\n\n# convert all other columns to factors\ndf <- df |>\n  mutate(across(-all_of(skip_convert), as.factor))\n```\n:::\n\n\nRecode factor levels for better interpretability\n\nFirst recode all variables that have levels of Yes/No\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# skip variables that are not factors or do not have levels of yes/no \nskip_recode <- c('BMI', 'GenHlth', 'MentHlth', 'PhysHlth',\n                 'Sex', 'Age', 'Education', 'Income')\n\nlvl_map <- c(\"0\" = \"No\", \"1\" = \"Yes\")\n\ndf <- df |>\n  mutate(across(-all_of(skip_recode), ~ recode(.x, !!!lvl_map)))\n```\n:::\n\n\nRecode remaining variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |>\n  mutate(\n    GenHlth = fct_recode(\n      GenHlth,\n      'Excellent' = '1',\n      'Very Good' = '2',\n      'Good' = '3',\n      'Fair' = '4',\n      'Poor' = '5'\n    ),\n    Sex = fct_recode(\n      Sex,\n      'Female' = '0',\n      'Male' = '1'\n    ),\n    Age = fct_recode(\n      Age,\n      '18-24' = '1',\n      '25-29' = '2',\n      '30-34' = '3',\n      '35-39' = '4',\n      '40-44' = '5',\n      '45-49' = '6',\n      '50-54' = '7',\n      '55-59' = '8',\n      '60-64' = '9',\n      '65-69' = '10',\n      '70-74' = '11',\n      '75-79' = '12',\n      '80+' = '13'\n      ),\n    Education = fct_recode(\n      Education,\n      'None' = '1',\n      'Elementary School' = '2',\n      'Some High School' = '3',\n      'High School' = '4',\n      'Some College' = '5',\n      'College Graduate' = '6',\n      ),\n    Income = fct_recode(\n      Income,\n      \"Less than $10k\" = \"1\",\n      \"$10k to < $15k\" = \"2\",\n      \"$15k to < $20k\" = \"3\",\n      \"$20k to < $25k\" = \"4\",\n      \"$25k to < $35k\" = \"5\",\n      \"$35k to < $50k\" = \"6\",\n      \"$50k to < $75k\" = \"7\",\n      \"$75k or more\" = \"8\"\n      ),\n    )\n```\n:::\n\n\n# Data Exploration\n\nNow we will look at some graphical and numerical summaries.\n\nNumber of participants without diabetes vs with diabetes\n\nThe data is very imbalanced, most participants do not have diabetes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Diabetes_binary)) +\n  geom_bar(fill = 'deepskyblue4') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nTwo-way contingency tables for Diabetes Status by all other categorical variables\n\nWe want to identify a subset of variables that may be useful predictors for Diabetes_binary, and comparing diabetes prevalence across the levels of each variable can give us an initial idea.\n\nWe can expect to that the proportions for participants without diabetes will be higher overall since there is a much larger number of those participants overall.\n\nA pattern that sticks out is that the proportion of participants with diabetes increase with age until ages 75+, when the proportion decreases.\n\nAnother pattern is that participants without diabetes have higher proportions for exercising, having health care coverage, eating fruits and veggies, no heart issues, and no heavy alcohol consumption. Some of these may be helpful predictor variables for modeling.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat_vars <- names(df)[sapply(df, is.factor)]\n# remove Diabetes_binary from the list so we don't two way table with itself\ncat_vars <- setdiff(cat_vars, \"Diabetes_binary\")\n\nfor (v in cat_vars) {\n  cat(\"\\n\")\n  cat(\"Diabetes_binary by\", v, \"\\n\")\n  print(round(prop.table(table(df$Diabetes_binary, df[[v]])), 3))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nDiabetes_binary by HighBP \n     \n         No   Yes\n  No  0.537 0.324\n  Yes 0.034 0.105\n\nDiabetes_binary by HighChol \n     \n         No   Yes\n  No  0.530 0.331\n  Yes 0.046 0.093\n\nDiabetes_binary by CholCheck \n     \n         No   Yes\n  No  0.036 0.824\n  Yes 0.001 0.138\n\nDiabetes_binary by Smoker \n     \n         No   Yes\n  No  0.490 0.371\n  Yes 0.067 0.072\n\nDiabetes_binary by Stroke \n     \n         No   Yes\n  No  0.833 0.028\n  Yes 0.126 0.013\n\nDiabetes_binary by HeartDiseaseorAttack \n     \n         No   Yes\n  No  0.798 0.063\n  Yes 0.108 0.031\n\nDiabetes_binary by PhysActivity \n     \n         No   Yes\n  No  0.192 0.669\n  Yes 0.051 0.088\n\nDiabetes_binary by Fruits \n     \n         No   Yes\n  No  0.308 0.553\n  Yes 0.058 0.082\n\nDiabetes_binary by Veggies \n     \n         No   Yes\n  No  0.155 0.706\n  Yes 0.034 0.105\n\nDiabetes_binary by HvyAlcoholConsump \n     \n         No   Yes\n  No  0.808 0.053\n  Yes 0.136 0.003\n\nDiabetes_binary by AnyHealthcare \n     \n         No   Yes\n  No  0.043 0.817\n  Yes 0.006 0.134\n\nDiabetes_binary by NoDocbcCost \n     \n         No   Yes\n  No  0.791 0.069\n  Yes 0.125 0.015\n\nDiabetes_binary by GenHlth \n     \n      Excellent Very Good  Good  Fair  Poor\n  No      0.174     0.326 0.245 0.086 0.030\n  Yes     0.004     0.025 0.053 0.039 0.018\n\nDiabetes_binary by DiffWalk \n     \n         No   Yes\n  No  0.744 0.117\n  Yes 0.088 0.052\n\nDiabetes_binary by Sex \n     \n      Female  Male\n  No   0.487 0.374\n  Yes  0.073 0.067\n\nDiabetes_binary by Age \n     \n      18-24 25-29 30-34 35-39 40-44 45-49 50-54 55-59 60-64 65-69 70-74 75-79\n  No  0.022 0.029 0.043 0.052 0.060 0.071 0.092 0.105 0.108 0.101 0.073 0.050\n  Yes 0.000 0.001 0.001 0.002 0.004 0.007 0.012 0.017 0.023 0.026 0.020 0.013\n     \n        80+\n  No  0.056\n  Yes 0.013\n\nDiabetes_binary by Education \n     \n       None Elementary School Some High School High School Some College\n  No  0.001             0.011            0.028       0.204        0.235\n  Yes 0.000             0.005            0.009       0.044        0.041\n     \n      College Graduate\n  No             0.382\n  Yes            0.041\n\nDiabetes_binary by Income \n     \n      Less than $10k $10k to < $15k $15k to < $20k $20k to < $25k\n  No           0.029          0.034          0.049          0.063\n  Yes          0.009          0.012          0.014          0.016\n     \n      $25k to < $35k $35k to < $50k $50k to < $75k $75k or more\n  No           0.084          0.123          0.150        0.328\n  Yes          0.018          0.021          0.021        0.028\n```\n\n\n:::\n:::\n\n\nBox Plot of BMI vs Diabetes Status\n\nNot as much difference between the groups of diabetes status as I expected. This may not be the most userful variable to use as a predictor in the models.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Diabetes_binary, y = BMI)) +\n  geom_boxplot(fill = \"deepskyblue4\") +\n  labs(x = \"Diabetes Status\",\n       y = \"BMI\",\n       title = \"BMI Distribution by Diabetes Status\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nDiabetes status by Age\n\nIn the no diabetes group, age 60-64 has the most subjects, whereas the diabetes group has the most subjects in the 65-69 age range.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Diabetes_binary, fill = Age)) +\n  geom_bar(position='dodge') +\n  labs(x = 'Diabetes Status',\n       title = 'Diabetes Status by Sex')\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nDiabetes Status by General Health Rating\n\nIn the no diabetes group, most subjects rated their general health as 'very good', whereas most of the subjects in the diabetes group rated their health as 'good; or 'fair'.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Diabetes_binary, fill = GenHlth)) +\n  geom_bar(position='dodge') +\n  labs(x = 'Diabetes Status',\n       title = 'Diabetes Status by General Health Rating')\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nDiabetes Status grouped by High Blood Pressure\n\nThere is a clear relationship between HighBP and Diabetes_binary, with more people in the Diabetes group having high blood pressure. This could be a useful predictor variable for modeling.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Diabetes_binary, fill = HighBP)) +\n  geom_bar(position='dodge') +\n  labs(x = 'Diabetes Status',\n       title = 'Diabetes Status by High Blood Pressure (Yes/No)')\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nDiabetes Status grouped by High Cholesterol\n\nThis plot is almost identical to the Diabetes status by HighBP plot. The number of subjects with high cholesterol is much lower than the number of subjects without high cholesterol in the no diabetes group, and vice versa for the diabetes group.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Diabetes_binary, fill = HighChol)) +\n  geom_bar(position='dodge') +\n  labs(x = 'Diabetes Status',\n       title = 'Diabetes Status by High Cholesterol (Yes/No)')\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nDistributions of PhysHlth and MentHlth\n\nThe distributions are almost identical, both are heavily skewed to the right- most subjects had no days of injury/illness or poor mental health in the last 30 days.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = PhysHlth)) +\n  geom_histogram(binwidth = 5, fill = \"deepskyblue4\") +\n  labs(x = '# of Days Physically Injured/Ill in Past 30 Days',\n       title = 'Distribution of Physical Health')\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df, aes(x = MentHlth)) +\n  geom_histogram(binwidth = 5, fill = \"deepskyblue4\") +\n  labs(x = '# of Days of Poor Mental Health in Past 30 Days',\n       title = 'Distribution of Physical Health')\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n:::\n\nClick [here](Modeling.html) to Visit the Modeling Page\n",
    "supporting": [
      "EDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}